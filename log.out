2.13.0
[PhysicalDevice(name='/physical_device:CPU:0', device_type='CPU'), PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU'), PhysicalDevice(name='/physical_device:GPU:1', device_type='GPU')]

['/root/work/truth/signal/CGLMP.npz', '/root/work/truth/signal/Higgs.npz', '/root/work/truth/signal/LeadLepton.npz', '/root/work/truth/signal/LeptonM.npz', '/root/work/truth/signal/LeptonP.npz', '/root/work/truth/signal/LmNu.npz', '/root/work/truth/signal/LpNu.npz', '/root/work/truth/signal/MET.npz', '/root/work/truth/signal/WmBoson.npz', '/root/work/truth/signal/WpBoson.npz', '/root/work/truth/signal/diLepton.npz', '/root/work/truth/signal/subLeadLepton.npz', '/root/work/truth/signal/xi_xyz.npz']

MET_kin shape: (2928862, 10)
       MET_px     MET_py     lep_p_E  ...   lep_m_px   lep_m_py   lep_m_pz
0   21.531590  58.661363   19.465703  ...  11.081455   2.673936  -3.847299
1  142.831582 -36.235636  131.817141  ... -13.096559  14.755815  63.403242
2   -4.344014 -53.593527   94.193734  ...   7.589698   1.677931  25.090863

[3 rows x 10 columns]
dinu_kin shape: (2928862, 11)
         nu_E      nu_px      nu_py  ...      Bxy        Byz       Bzx
0   75.449547  -5.933027  30.212092  ...  5.37961  -0.375224   8.00803
1  226.696359  59.309223 -25.300893  ... -4.33158  15.150000  -5.99553
2    8.372312  -7.214337  -4.222511  ...  4.61210  21.715400  19.46050

[3 rows x 11 columns]

mean: 7.154943838729907e-18; std: 1.000000000000001
mean: 6.080290770393208e-18; std: 0.999999999999999
X (Interest)
Training data shape: (8000, 11);
Testing data shape: (2000, 11).
Y (Observed)
Training data shape: (8000, 10);
Testing data shape: (2000, 10).

pad_x (8000, 1)
x (8000, 12)
y (8000, 10)
z (8000, 2)
Input dataset shape -> X:(8000, 12), Y: (8000, 12)

Model: "NVP"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 Layer0 (TwoNVPCouplingLaye  multiple                  19108     
 rs)                                                             
                                                                 
 Layer1 (TwoNVPCouplingLaye  multiple                  19108     
 rs)                                                             
                                                                 
 Layer2 (TwoNVPCouplingLaye  multiple                  19108     
 rs)                                                             
                                                                 
=================================================================
Total params: 57324 (224.06 KB)
Trainable params: 57288 (223.78 KB)
Non-trainable params: 36 (288.00 Byte)
_________________________________________________________________
=== Started at 2023-11-17 14h:06m:13s ===
Epoch 1/64
 2023-11-17 14h:07m:14s | Epoch: 01/64 | total_loss=5.868633 forward_loss=5.089028 latent_loss=0.068535 rev_loss=0.711070
625/625 - 61s - total_loss: 5.8686 - forward_loss: 5.0890 - latent_loss: 0.0685 - rev_loss: 0.7111 - 61s/epoch - 97ms/step
Epoch 2/64
625/625 - 37s - total_loss: 3.6727 - forward_loss: 3.0162 - latent_loss: 0.0675 - rev_loss: 0.5890 - 37s/epoch - 59ms/step
Epoch 3/64
625/625 - 41s - total_loss: 5.1980 - forward_loss: 4.5612 - latent_loss: 0.0763 - rev_loss: 0.5604 - 41s/epoch - 66ms/step
Epoch 4/64
625/625 - 39s - total_loss: 3.5833 - forward_loss: 2.9482 - latent_loss: 0.0792 - rev_loss: 0.5559 - 39s/epoch - 63ms/step
Epoch 5/64
625/625 - 41s - total_loss: 3.3964 - forward_loss: 2.7965 - latent_loss: 0.0791 - rev_loss: 0.5209 - 41s/epoch - 65ms/step
Epoch 6/64
625/625 - 37s - total_loss: 4.3051 - forward_loss: 3.7216 - latent_loss: 0.0749 - rev_loss: 0.5086 - 37s/epoch - 58ms/step
Epoch 7/64
625/625 - 35s - total_loss: 3.2155 - forward_loss: 2.6548 - latent_loss: 0.0728 - rev_loss: 0.4879 - 35s/epoch - 56ms/step
Epoch 8/64
625/625 - 36s - total_loss: 2.8651 - forward_loss: 2.3095 - latent_loss: 0.0713 - rev_loss: 0.4843 - 36s/epoch - 57ms/step
Epoch 9/64
625/625 - 36s - total_loss: 6.2716 - forward_loss: 5.6973 - latent_loss: 0.0671 - rev_loss: 0.5072 - 36s/epoch - 58ms/step
Epoch 10/64
625/625 - 31s - total_loss: 3.2812 - forward_loss: 2.7205 - latent_loss: 0.0688 - rev_loss: 0.4919 - 31s/epoch - 50ms/step
Epoch 11/64
625/625 - 39s - total_loss: 4.9786 - forward_loss: 4.4248 - latent_loss: 0.0704 - rev_loss: 0.4834 - 39s/epoch - 62ms/step
Epoch 12/64
625/625 - 32s - total_loss: 3.2925 - forward_loss: 2.7425 - latent_loss: 0.0677 - rev_loss: 0.4823 - 32s/epoch - 51ms/step
Epoch 13/64
625/625 - 30s - total_loss: 3.5507 - forward_loss: 2.9803 - latent_loss: 0.0699 - rev_loss: 0.5005 - 30s/epoch - 48ms/step
Epoch 14/64
625/625 - 31s - total_loss: 2.8343 - forward_loss: 2.2823 - latent_loss: 0.0654 - rev_loss: 0.4866 - 31s/epoch - 50ms/step
Epoch 15/64
625/625 - 36s - total_loss: 3.5951 - forward_loss: 3.0374 - latent_loss: 0.0728 - rev_loss: 0.4848 - 36s/epoch - 57ms/step
Epoch 16/64
625/625 - 34s - total_loss: 3.3375 - forward_loss: 2.7995 - latent_loss: 0.0689 - rev_loss: 0.4691 - 34s/epoch - 55ms/step
Epoch 17/64
625/625 - 35s - total_loss: 3.3234 - forward_loss: 2.7713 - latent_loss: 0.0686 - rev_loss: 0.4836 - 35s/epoch - 56ms/step
Epoch 18/64
625/625 - 33s - total_loss: 3.3082 - forward_loss: 2.7607 - latent_loss: 0.0640 - rev_loss: 0.4835 - 33s/epoch - 53ms/step
Epoch 19/64
625/625 - 36s - total_loss: 3.1380 - forward_loss: 2.5670 - latent_loss: 0.0697 - rev_loss: 0.5012 - 36s/epoch - 58ms/step
Epoch 20/64
625/625 - 35s - total_loss: 4.9944 - forward_loss: 4.4474 - latent_loss: 0.0645 - rev_loss: 0.4825 - 35s/epoch - 55ms/step
Epoch 21/64
625/625 - 26s - total_loss: 5.0390 - forward_loss: 4.4986 - latent_loss: 0.0642 - rev_loss: 0.4761 - 26s/epoch - 42ms/step
Epoch 22/64
625/625 - 36s - total_loss: 4.1954 - forward_loss: 3.6304 - latent_loss: 0.0675 - rev_loss: 0.4975 - 36s/epoch - 58ms/step
Epoch 23/64
625/625 - 30s - total_loss: 3.2783 - forward_loss: 2.7242 - latent_loss: 0.0663 - rev_loss: 0.4877 - 30s/epoch - 48ms/step
Epoch 24/64
625/625 - 27s - total_loss: 2.7921 - forward_loss: 2.2339 - latent_loss: 0.0676 - rev_loss: 0.4906 - 27s/epoch - 44ms/step
Epoch 25/64
625/625 - 35s - total_loss: 3.5153 - forward_loss: 2.9787 - latent_loss: 0.0670 - rev_loss: 0.4695 - 35s/epoch - 56ms/step
Epoch 26/64
625/625 - 36s - total_loss: 3.2095 - forward_loss: 2.6501 - latent_loss: 0.0684 - rev_loss: 0.4910 - 36s/epoch - 58ms/step
Epoch 27/64
625/625 - 31s - total_loss: 3.2764 - forward_loss: 2.7342 - latent_loss: 0.0626 - rev_loss: 0.4796 - 31s/epoch - 50ms/step
Epoch 28/64
625/625 - 29s - total_loss: 3.2218 - forward_loss: 2.6737 - latent_loss: 0.0677 - rev_loss: 0.4804 - 29s/epoch - 46ms/step
Epoch 29/64
625/625 - 31s - total_loss: 3.5536 - forward_loss: 3.0102 - latent_loss: 0.0655 - rev_loss: 0.4779 - 31s/epoch - 50ms/step
Epoch 30/64
625/625 - 31s - total_loss: 4.7460 - forward_loss: 4.1837 - latent_loss: 0.0661 - rev_loss: 0.4961 - 31s/epoch - 49ms/step
Epoch 31/64
625/625 - 34s - total_loss: 3.7468 - forward_loss: 3.2137 - latent_loss: 0.0660 - rev_loss: 0.4672 - 34s/epoch - 54ms/step
Epoch 32/64
625/625 - 33s - total_loss: 4.1906 - forward_loss: 3.6451 - latent_loss: 0.0673 - rev_loss: 0.4783 - 33s/epoch - 54ms/step
Epoch 33/64
625/625 - 32s - total_loss: 2.9450 - forward_loss: 2.3826 - latent_loss: 0.0710 - rev_loss: 0.4914 - 32s/epoch - 51ms/step
Epoch 34/64
625/625 - 31s - total_loss: 4.9165 - forward_loss: 4.3725 - latent_loss: 0.0677 - rev_loss: 0.4763 - 31s/epoch - 49ms/step
Epoch 35/64
625/625 - 30s - total_loss: 3.2074 - forward_loss: 2.6629 - latent_loss: 0.0655 - rev_loss: 0.4790 - 30s/epoch - 47ms/step
Epoch 36/64
625/625 - 31s - total_loss: 3.5349 - forward_loss: 2.9920 - latent_loss: 0.0626 - rev_loss: 0.4803 - 31s/epoch - 49ms/step
Epoch 37/64
625/625 - 32s - total_loss: 3.1396 - forward_loss: 2.5884 - latent_loss: 0.0618 - rev_loss: 0.4894 - 32s/epoch - 51ms/step
Epoch 38/64
625/625 - 32s - total_loss: 3.8275 - forward_loss: 3.2806 - latent_loss: 0.0631 - rev_loss: 0.4837 - 32s/epoch - 52ms/step
Epoch 39/64
625/625 - 32s - total_loss: 2.9303 - forward_loss: 2.3896 - latent_loss: 0.0664 - rev_loss: 0.4743 - 32s/epoch - 52ms/step
Epoch 40/64
625/625 - 35s - total_loss: 3.1023 - forward_loss: 2.5602 - latent_loss: 0.0691 - rev_loss: 0.4729 - 35s/epoch - 56ms/step
Epoch 41/64
625/625 - 31s - total_loss: 2.9713 - forward_loss: 2.4322 - latent_loss: 0.0631 - rev_loss: 0.4760 - 31s/epoch - 49ms/step
Epoch 42/64
625/625 - 33s - total_loss: 3.4805 - forward_loss: 2.9308 - latent_loss: 0.0638 - rev_loss: 0.4860 - 33s/epoch - 53ms/step
Epoch 43/64
625/625 - 33s - total_loss: 3.3032 - forward_loss: 2.7575 - latent_loss: 0.0652 - rev_loss: 0.4805 - 33s/epoch - 53ms/step
Epoch 44/64
625/625 - 29s - total_loss: 3.5305 - forward_loss: 2.9736 - latent_loss: 0.0626 - rev_loss: 0.4942 - 29s/epoch - 46ms/step
Epoch 45/64
625/625 - 28s - total_loss: 4.6268 - forward_loss: 4.0765 - latent_loss: 0.0646 - rev_loss: 0.4857 - 28s/epoch - 45ms/step
Epoch 46/64
625/625 - 26s - total_loss: 3.2096 - forward_loss: 2.6648 - latent_loss: 0.0665 - rev_loss: 0.4783 - 26s/epoch - 41ms/step
Epoch 47/64
625/625 - 27s - total_loss: 2.9123 - forward_loss: 2.3730 - latent_loss: 0.0635 - rev_loss: 0.4758 - 27s/epoch - 43ms/step
Epoch 48/64
625/625 - 31s - total_loss: 3.2212 - forward_loss: 2.6831 - latent_loss: 0.0634 - rev_loss: 0.4747 - 31s/epoch - 49ms/step
Epoch 49/64
625/625 - 25s - total_loss: 3.0980 - forward_loss: 2.5537 - latent_loss: 0.0648 - rev_loss: 0.4795 - 25s/epoch - 39ms/step
Epoch 50/64
625/625 - 25s - total_loss: 3.6851 - forward_loss: 3.1488 - latent_loss: 0.0617 - rev_loss: 0.4745 - 25s/epoch - 39ms/step
Epoch 51/64
625/625 - 30s - total_loss: 3.3666 - forward_loss: 2.8282 - latent_loss: 0.0625 - rev_loss: 0.4759 - 30s/epoch - 48ms/step
Epoch 52/64
625/625 - 36s - total_loss: 2.5786 - forward_loss: 2.0406 - latent_loss: 0.0652 - rev_loss: 0.4728 - 36s/epoch - 58ms/step
Epoch 53/64
625/625 - 27s - total_loss: 4.0481 - forward_loss: 3.4972 - latent_loss: 0.0652 - rev_loss: 0.4858 - 27s/epoch - 44ms/step
Epoch 54/64
625/625 - 33s - total_loss: 3.6531 - forward_loss: 3.1169 - latent_loss: 0.0606 - rev_loss: 0.4756 - 33s/epoch - 52ms/step
Epoch 55/64
625/625 - 21s - total_loss: 2.8623 - forward_loss: 2.3126 - latent_loss: 0.0666 - rev_loss: 0.4831 - 21s/epoch - 33ms/step
Epoch 56/64
625/625 - 28s - total_loss: 2.9741 - forward_loss: 2.4261 - latent_loss: 0.0691 - rev_loss: 0.4789 - 28s/epoch - 45ms/step
Epoch 57/64
625/625 - 32s - total_loss: 3.7166 - forward_loss: 3.1713 - latent_loss: 0.0637 - rev_loss: 0.4816 - 32s/epoch - 52ms/step
Epoch 58/64
625/625 - 28s - total_loss: 3.1143 - forward_loss: 2.5425 - latent_loss: 0.0663 - rev_loss: 0.5055 - 28s/epoch - 44ms/step
Epoch 59/64
625/625 - 29s - total_loss: 3.6769 - forward_loss: 3.1389 - latent_loss: 0.0610 - rev_loss: 0.4769 - 29s/epoch - 46ms/step
Epoch 60/64
625/625 - 34s - total_loss: 3.9311 - forward_loss: 3.3897 - latent_loss: 0.0600 - rev_loss: 0.4813 - 34s/epoch - 54ms/step
Epoch 61/64
625/625 - 31s - total_loss: 3.6777 - forward_loss: 3.1280 - latent_loss: 0.0633 - rev_loss: 0.4865 - 31s/epoch - 50ms/step
Epoch 62/64
625/625 - 30s - total_loss: 2.9935 - forward_loss: 2.4443 - latent_loss: 0.0663 - rev_loss: 0.4830 - 30s/epoch - 49ms/step
Epoch 63/64
625/625 - 29s - total_loss: 2.9110 - forward_loss: 2.3733 - latent_loss: 0.0625 - rev_loss: 0.4752 - 29s/epoch - 46ms/step
Epoch 64/64
625/625 - 28s - total_loss: 2.8643 - forward_loss: 2.3326 - latent_loss: 0.0660 - rev_loss: 0.4657 - 28s/epoch - 45ms/step
=== Time elapsed: 34.5659 min ===
pz -> Pearson coeff: 0.206
E  -> Pearson coeff: -0.054
pt -> Pearson coeff: 0.279
====================== Finished!! ======================
